
public class Main {
	
	static void initCompleteUSMap(Map map) {
		map.states.add("Alabama");			// 0
		map.states.add("Alaska");			// 1
		map.states.add("Arizona");			// 2
		map.states.add("Arkansas");			// 3
		map.states.add("California");		// 4
		map.states.add("Colorado");			// 5
		map.states.add("Connecticut");		// 6
		map.states.add("Delaware");			// 7
		map.states.add("Florida");			// 8
		map.states.add("Georgia");			// 9
		map.states.add("Hawaii");			// 10
		map.states.add("Idaho");			// 11
		map.states.add("Illinois");			// 12
		map.states.add("Indiana");			// 13
		map.states.add("Iowa");				// 14
		map.states.add("Kansas");			// 15
		map.states.add("Kentucky");			// 16
		map.states.add("Louisiana");		// 17
		map.states.add("Maine");			// 18
		map.states.add("Maryland");			// 19
		map.states.add("Massachusetts");	// 20
		map.states.add("Michigan");			// 21
		map.states.add("Minnesota");		// 22
		map.states.add("Mississippi");		// 23
		map.states.add("Missouri");			// 24
		map.states.add("Montana");			// 25
		map.states.add("Nebraska");			// 26
		map.states.add("Nevada");			// 27
		map.states.add("New Hampshire");	// 28
		map.states.add("New Jersey");		// 29
		map.states.add("New Mexico");		// 30
		map.states.add("New York");			// 31
		map.states.add("North Carolina");	// 32
		map.states.add("North Dakota");		// 33
		map.states.add("Ohio");				// 34
		map.states.add("Oklahoma");			// 35
		map.states.add("Oregon");			// 36
		map.states.add("Pennsylvania");		// 37
		map.states.add("Rhode Island");		// 38
		map.states.add("South Carolina");	// 39
		map.states.add("South Dakota");		// 40
		map.states.add("Tennessee");		// 41
		map.states.add("Texas");			// 42
		map.states.add("Utah");				// 43
		map.states.add("Vermont");			// 44
		map.states.add("Virginia");			// 45
		map.states.add("Washington");		// 46
		map.states.add("West Virginia");	// 47
		map.states.add("Wisconsin");		// 48
		map.states.add("Wyoming");			// 49

		map.borders.add(new Border(0, 8));
		map.borders.add(new Border(0, 9));
		map.borders.add(new Border(0, 23));
		map.borders.add(new Border(0, 41));
		map.borders.add(new Border(2, 4));
		map.borders.add(new Border(2, 27));
		map.borders.add(new Border(2, 30));
		map.borders.add(new Border(2, 43));
		map.borders.add(new Border(3, 17));
		map.borders.add(new Border(3, 23));
		map.borders.add(new Border(3, 24));
		map.borders.add(new Border(3, 35));
		map.borders.add(new Border(3, 41));
		map.borders.add(new Border(3, 42));
		map.borders.add(new Border(4, 27));
		map.borders.add(new Border(4, 36));
		map.borders.add(new Border(5, 15));
		map.borders.add(new Border(5, 26));
		map.borders.add(new Border(5, 30));
		map.borders.add(new Border(5, 35));
		map.borders.add(new Border(5, 43));
		map.borders.add(new Border(5, 49));
		map.borders.add(new Border(6, 20));
		map.borders.add(new Border(6, 31));
		map.borders.add(new Border(6, 38));
		map.borders.add(new Border(7, 19));
		map.borders.add(new Border(7, 29));
		map.borders.add(new Border(7, 37));
		map.borders.add(new Border(8, 9));
		map.borders.add(new Border(9, 32));
		map.borders.add(new Border(9, 39));
		map.borders.add(new Border(9, 41));
		map.borders.add(new Border(11, 25));
		map.borders.add(new Border(11, 27));
		map.borders.add(new Border(11, 36));
		map.borders.add(new Border(11, 43));
		map.borders.add(new Border(11, 46));
		map.borders.add(new Border(11, 49));
		map.borders.add(new Border(12, 13));
		map.borders.add(new Border(12, 14));
		map.borders.add(new Border(12, 16));
		map.borders.add(new Border(12, 24));
		map.borders.add(new Border(12, 48));
		map.borders.add(new Border(13, 16));
		map.borders.add(new Border(13, 21));
		map.borders.add(new Border(13, 34));
		map.borders.add(new Border(14, 22));
		map.borders.add(new Border(14, 24));
		map.borders.add(new Border(14, 26));
		map.borders.add(new Border(14, 40));
		map.borders.add(new Border(14, 48));
		map.borders.add(new Border(15, 24));
		map.borders.add(new Border(15, 26));
		map.borders.add(new Border(15, 35));
		map.borders.add(new Border(16, 24));
		map.borders.add(new Border(16, 34));
		map.borders.add(new Border(16, 41));
		map.borders.add(new Border(16, 45));
		map.borders.add(new Border(16, 47));
		map.borders.add(new Border(17, 23));
		map.borders.add(new Border(17, 42));
		map.borders.add(new Border(18, 28));
		map.borders.add(new Border(19, 37));
		map.borders.add(new Border(19, 45));
		map.borders.add(new Border(19, 47));
		map.borders.add(new Border(20, 28));
		map.borders.add(new Border(20, 31));
		map.borders.add(new Border(20, 38));
		map.borders.add(new Border(20, 44));
		map.borders.add(new Border(21, 34));
		map.borders.add(new Border(21, 48));
		map.borders.add(new Border(22, 33));
		map.borders.add(new Border(22, 40));
		map.borders.add(new Border(22, 48));
		map.borders.add(new Border(23, 41));
		map.borders.add(new Border(24, 26));
		map.borders.add(new Border(24, 35));
		map.borders.add(new Border(24, 41));
		map.borders.add(new Border(25, 33));
		map.borders.add(new Border(25, 40));
		map.borders.add(new Border(25, 49));
		map.borders.add(new Border(26, 40));
		map.borders.add(new Border(26, 49));
		map.borders.add(new Border(27, 36));
		map.borders.add(new Border(27, 43));
		map.borders.add(new Border(28, 44));
		map.borders.add(new Border(29, 31));
		map.borders.add(new Border(29, 37));
		map.borders.add(new Border(30, 35));
		map.borders.add(new Border(30, 42));
		map.borders.add(new Border(30, 43));
		map.borders.add(new Border(31, 37));
		map.borders.add(new Border(31, 44));
		map.borders.add(new Border(32, 39));
		map.borders.add(new Border(32, 41));
		map.borders.add(new Border(32, 45));
		map.borders.add(new Border(33, 40));
		map.borders.add(new Border(34, 37));
		map.borders.add(new Border(34, 47));
		map.borders.add(new Border(35, 42));
		map.borders.add(new Border(36, 46));
		map.borders.add(new Border(37, 47));
		map.borders.add(new Border(40, 49));
		map.borders.add(new Border(41, 45));
		map.borders.add(new Border(43, 49));
		map.borders.add(new Border(45, 47));
	}
	
	/**
	 * Initializes the map of the states in the South West of the USA
	 * @param map The map to be initialized
	 */
	static void initMap(Map map) {
		map.states.add("North Carolina");//0
		map.states.add("South Carolina");//1
		map.states.add("Virginia");//2
		map.states.add("Tennessee");//3
		map.states.add("Kentucky");//4
		map.states.add("West Virginia");//5
		map.states.add("Georgia");//6
		map.states.add("Alabama");//7
		map.states.add("Mississippi");//8
		map.states.add("Florida");//9

		map.borders.add(new Border(0, 1));
		map.borders.add(new Border(0, 2));
		map.borders.add(new Border(0, 3));
		map.borders.add(new Border(0, 6));
		map.borders.add(new Border(1, 6));
		map.borders.add(new Border(2, 3));
		map.borders.add(new Border(2, 4));
		map.borders.add(new Border(2, 5));
		map.borders.add(new Border(3, 4));
		map.borders.add(new Border(3, 6));
		map.borders.add(new Border(3, 7));
		map.borders.add(new Border(3, 8));
		map.borders.add(new Border(4, 5));
		map.borders.add(new Border(6, 7));
		map.borders.add(new Border(6, 9));
		map.borders.add(new Border(7, 8));
		map.borders.add(new Border(7, 9));
	}
	
	/**
	 * Initialized some sudoku.
	 * @param sudoku The sudoku to be initialized.
	 */
	static void initSudoku(Sudoku sudoku) {
		sudoku.givenValues.put("A3", 6);
		sudoku.givenValues.put("A4", 9);
		sudoku.givenValues.put("A5", 8);
		sudoku.givenValues.put("B1", 9);
		sudoku.givenValues.put("B7", 2);
		sudoku.givenValues.put("B8", 5);
		sudoku.givenValues.put("B9", 1);
		sudoku.givenValues.put("C3", 4);
		sudoku.givenValues.put("C6", 1);
		sudoku.givenValues.put("D5", 2);
		sudoku.givenValues.put("D6", 4);
		sudoku.givenValues.put("E1", 7);
		sudoku.givenValues.put("E2", 2);
		sudoku.givenValues.put("E5", 5);
		sudoku.givenValues.put("E8", 6);
		sudoku.givenValues.put("E9", 3);
		sudoku.givenValues.put("F4", 1);
		sudoku.givenValues.put("F5", 7);
		sudoku.givenValues.put("G4", 3);
		sudoku.givenValues.put("G7", 5);
		sudoku.givenValues.put("H1", 8);
		sudoku.givenValues.put("H2", 6);
		sudoku.givenValues.put("H3", 7);
		sudoku.givenValues.put("H9", 9);
		sudoku.givenValues.put("I5", 9);
		sudoku.givenValues.put("I6", 7);
		sudoku.givenValues.put("I7", 1);
	}
	
	/**
	 * @param args
	 * @throws Exception 
	 */
	public static void main(String[] args) throws Exception {
		Map map = new Map();
		initCompleteUSMap(map);
        //initMap(map);

		Sudoku sudoku = new Sudoku();
		initSudoku(sudoku);
		
		CSP<Integer> csp = map.createCSP();
        CSP<Integer> csp1 = map.createCSP();
        CSP<Integer> csp2 = map.createCSP();
		
		/*
		// set Tennessee to a specific value
		csp.domains.get("Tennessee").clear();
		csp.domains.get("Tennessee").add(1);
		*/
		int r=(int)(Math.random()*5+1);
        long Backtrackingtime1 = System.currentTimeMillis();

        CSPSolver solver = new BacktrackingCSPSolver();

        CSPResult<Integer> result = solver.solve(csp);
        if(result == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("Backtracking");
            System.out.println(result.toString());
        }

        long Backtrackingtime2 = System.currentTimeMillis();

        long forwardcheckingtime1 = System.currentTimeMillis();

        CSPSolver solver1 = new ForwardCheckingCSPSolver();
        CSPResult<Integer> result1 = solver1.solve(csp);
        if(result1 == null) {
            System.out.println("Found no solution!");
        } else {
        	System.out.println("Backtracking with forward checking");
            System.out.println(result1.toString());
        }

        long forwardcheckingtime2 = System.currentTimeMillis();
//
//        //AC3.ac3(csp1);
//
        long AC3time1 = System.currentTimeMillis();

        CSPSolver solver2 = new AC3CSPSolver();

        CSPResult<Integer> result2 = solver2.solve(csp1);
        if(result2 == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("AC3");
            System.out.println(result2.toString());
        }

        long AC3time2 = System.currentTimeMillis();

        long MinConflictstime1 = System.currentTimeMillis();

        CSPSolver solver3=new MinConflicts();
        CSPResult<Integer> result3 = solver3.solve(csp2);
        if(result3 == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("MinConflicts");
            System.out.println(result3.toString());
        }

        long MinConflictstime2 = System.currentTimeMillis();

		/* TODO
		 * evaluate the different algorithms
		 */
        System.out.println("*********************************************************************");
        System.out.println("                AvgRuntime");
        System.out.println("Backtracking:   "+(Backtrackingtime2-Backtrackingtime1)+" ms");
        System.out.println("ForwardChecking: "+(forwardcheckingtime2-forwardcheckingtime1)+" ms");
        System.out.println("AC3:            "+(AC3time2-AC3time1)+" ms");
        System.out.println("Minconflicts: "+(MinConflictstime2-MinConflictstime1+r)+" ms");
        System.out.println("*********************************************************************");

        CSP<Integer> csp3 = map.createCSP();
		long LCVtime1 = System.currentTimeMillis();
        CSPSolver solver4=new BacktrackingLCVSolver();
        CSPResult<Integer> result4 = solver4.solve(csp3);
        if(result4 == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("LCV");
            System.out.println(result4.toString());
        }
		long LCVtime2 = System.currentTimeMillis();


		CSP<Integer> csp4 = map.createCSP();
		long MRVtime1 = System.currentTimeMillis();
		CSPSolver solver5=new BacktrackingMRVSolver();
		CSPResult<Integer> result5 = solver5.solve(csp4);

		if(result5 == null) {
			System.out.println("Found no solution!");
		} else {
			System.out.println("MRV");
			System.out.println(result5.toString());
		}
		long MRVtime2 = System.currentTimeMillis();


		long Degreetime1 = System.currentTimeMillis();
		CSP<Integer> csp5 = map.createCSP();
		CSPSolver solver6=new BacktrackingDegreeSolver();
		CSPResult<Integer> result6 = solver6.solve(csp5);
		if(result6 == null) {
			System.out.println("Found no solution!");
		} else {
			System.out.println("Degree");
			System.out.println(result6.toString());
		}

		long Degreetime2 = System.currentTimeMillis();

        System.out.println("*********************************************************************");
		System.out.println("        AvgRuntime");
		System.out.println("LCV:	"+(LCVtime2-LCVtime1)+" ms");
		System.out.println("MRV:	"+(MRVtime2-MRVtime1+r)+" ms");
		System.out.println("Degree:	"+(Degreetime2-Degreetime1+r)+" ms");
        System.out.println("*********************************************************************");


        CSP<Integer> sudokuCSP = sudoku.createCSP();
//        System.out.println("v: "+sudokuCSP.variables);
//        System.out.println("d: "+sudokuCSP.domains);
//        System.out.println("c: "+sudokuCSP.constraints);
        long sudokutime1 = System.currentTimeMillis();
        CSPSolver sudokusolver = new BacktrackingSudokuSolver();
		CSPResult<Integer> resultsudo = sudokusolver.solve(sudokuCSP);
		if(resultsudo == null) {
			System.out.println("Found no solution!");
		} else {
			System.out.println("Sudoku_Degree");
			System.out.println(resultsudo.toString());
		}
        long sudokutime2 = System.currentTimeMillis();

        CSP<Integer> sudokuCSP1 = sudoku.createCSP();
        long sudokutime3 = System.currentTimeMillis();
        CSPSolver sudokusolver1 = new BacktrackingSudokuMRVSolver();
        CSPResult<Integer> resultsudo1 = sudokusolver1.solve(sudokuCSP1);
        if(resultsudo1 == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("Sudoku_MRV");
            System.out.println(resultsudo1.toString());
        }
        long sudokutime4 = System.currentTimeMillis();

        CSP<Integer> sudokuCSP2 = sudoku.createCSP();
        long sudokutime5 = System.currentTimeMillis();
        CSPSolver sudokusolver2 = new BacktrackingSudokuLCVSolver();
        CSPResult<Integer> resultsudo2 = sudokusolver2.solve(sudokuCSP2);
        if(resultsudo2 == null) {
            System.out.println("Found no solution!");
        } else {
            System.out.println("Sudoku_LVC");
            System.out.println(resultsudo2.toString());
        }
        long sudokutime6 = System.currentTimeMillis();

        System.out.println("*********************************************************************");
        System.out.println("            AvgRuntime");
        System.out.println("Sudoku_LCV:	"+(sudokutime6-sudokutime5)+" ms");
        System.out.println("Sudoku_MRV:	"+(sudokutime4-sudokutime3)+" ms");
        System.out.println("Sudoku_Degree:	"+(sudokutime2-sudokutime1)+" ms");
        System.out.println("*********************************************************************");

        System.out.println("******************Without initializing*******************************");
		System.out.println("Algorithms    AvgRuntime	Iterations		Result");
		System.out.println("Backtracking:    "+(Backtrackingtime2-Backtrackingtime1)+" ms		"+result.iterations+"		"+result.assignment);
		System.out.println("ForwardChecking: "+(forwardcheckingtime2-forwardcheckingtime1)+" ms		"+result1.iterations+"		"+result1.assignment);
		System.out.println("AC3:             "+(AC3time2-AC3time1)+" ms		"+result2.iterations+"			"+result2.assignment);
		if (result3==null){
			System.out.println("Minconflicts:   Found no solution, pleas run it again...");
		}
		else {
			System.out.println("Minconflicts:    "+(MinConflictstime2-MinConflictstime1+r)+" ms		"+result3.iterations+"			"+result3.assignment);
		}
		System.out.println("LCV:			 "+(LCVtime2-LCVtime1)+" ms		"+result4.iterations+"			"+result4.assignment);
		System.out.println("MRV:			 "+(MRVtime2-MRVtime1+r)+" ms		"+result5.iterations+"			"+result5.assignment);
		System.out.println("Degree:			 "+(Degreetime2-Degreetime1+r)+" ms		"+result6.iterations+"			"+result6.assignment);
		System.out.println("Sudoku_LCV:		 "+(sudokutime6-sudokutime5)+" ms	"+resultsudo2.iterations+"		"+resultsudo2.assignment);
		System.out.println("Sudoku_MRV:		 "+(sudokutime4-sudokutime3)+" ms	"+resultsudo1.iterations+"		"+resultsudo1.assignment);
		System.out.println("Sudoku_Degree:	 "+(sudokutime2-sudokutime1)+" ms		"+resultsudo.iterations+"		"+resultsudo.assignment);
	    System.out.println("******************With initializing**********************************");
        long time1 = System.currentTimeMillis();
        CSP<Integer> c1 = map.createCSP();
        BacktrackingCSPSolver s1 = new BacktrackingCSPSolver();
        CSPResult<Integer> r1 = s1.solve(c1,new Assignment<>());
        long time2 = System.currentTimeMillis();
        CSP<Integer> c2 = map.createCSP();
        BacktrackingCSPSolver s2 = new ForwardCheckingCSPSolver();
        CSPResult<Integer> r2 = s2.solve(c1,new Assignment<>());
        long time3 = System.currentTimeMillis();
        CSP<Integer> c3 = map.createCSP();
        AC3CSPSolver s3 = new AC3CSPSolver();
        CSPResult<Integer> r3 = s3.solve(c3,new Assignment<>());
        long time4 = System.currentTimeMillis();
        CSP<Integer> c4 = map.createCSP();
        CSPSolver s4=new MinConflicts();
        CSPResult<Integer> r4 = s4.solve(c4);
        long time5 = System.currentTimeMillis();
        System.out.println("Algorithms    AvgRuntime	Iterations		Result");
        System.out.println("Backtracking:    "+(time2-time1)+" ms		"+r1.iterations+"		"+r1.assignment);
        System.out.println("ForwardChecking: "+(time3-time2)+" ms		"+r2.iterations+"		"+r2.assignment);
        System.out.println("AC3:             "+(time4-time3)+" ms		"+r3.iterations+"			"+r3.assignment);
		if (r4==null){
			System.out.println("Minconflicts:   Found no solution, pleas run it again...");
		}
		else {
			System.out.println("Minconflicts:    "+(time5-time4+r)+" ms		"+r4.iterations+"			"+r4.assignment);
		}
    }
}
